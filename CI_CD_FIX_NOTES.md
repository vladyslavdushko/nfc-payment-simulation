# üîß CI/CD –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è - Serial Port Issue

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç—ñ–≤ —É CI/CD —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ (GitHub Actions) –≤–∏–Ω–∏–∫–∞–ª–∞ –ø–æ–º–∏–ª–∫–∞:

```
SerialException: [Errno 2] could not open port COM4
```

**–ü—Ä–∏—á–∏–Ω–∞:** `serial_reader.py` –Ω–∞–º–∞–≥–∞–≤—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏ COM-–ø–æ—Ä—Ç –ø—Ä–∏ —ñ–º–ø–æ—Ä—Ç—ñ –º–æ–¥—É–ª—è, –∞–ª–µ COM-–ø–æ—Ä—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ –≤ CI/CD —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ (Linux containers).

---

## –†—ñ—à–µ–Ω–Ω—è

### 1Ô∏è‚É£ –ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è `serial_reader.py`

–î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –∑–º—ñ–Ω–Ω–æ—ó –æ—Ç–æ—á–µ–Ω–Ω—è `CI` –ø–µ—Ä–µ–¥ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é serial –ø–æ—Ä—Ç—É:

```python
# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è serial –ø–æ—Ä—Ç—É (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –≤ CI/CD —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ)
ser = None
if os.getenv('CI') != 'true':
    try:
        ser = serial.Serial(COM_PORT, BAUD_RATE, timeout=TIMEOUT)
        time.sleep(2.5)
        print("Listening on", COM_PORT)
    except serial.SerialException as e:
        print(f"Warning: Could not open serial port: {e}")
        ser = None
else:
    print("CI/CD environment detected, skipping serial port initialization")
```

**–ó–∞—Ö–∏—Å—Ç main loop:**

```python
# Main loop (—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ serial –ø–æ—Ä—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π)
if ser is not None:
    while True:
        # ... –∫–æ–¥ —Ä–æ–±–æ—Ç–∏ –∑ serial –ø–æ—Ä—Ç–æ–º ...
else:
    print("Serial port not available, running in test mode")
```

### 2Ô∏è‚É£ –û–Ω–æ–≤–ª–µ–Ω–Ω—è `test_serial_reader.py`

–î–æ–¥–∞–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó `CI=true` –ø–µ—Ä–µ–¥ —ñ–º–ø–æ—Ä—Ç–æ–º:

```python
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ CI –∑–º—ñ–Ω–Ω—É –ø–µ—Ä–µ–¥ —ñ–º–ø–æ—Ä—Ç–æ–º (—è–∫—â–æ —â–µ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)
if 'CI' not in os.environ:
    os.environ['CI'] = 'true'

import serial_reader
```

### 3Ô∏è‚É£ –û–Ω–æ–≤–ª–µ–Ω–Ω—è GitHub Actions workflows

–Ø–≤–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–º—ñ–Ω–Ω—É `CI=true` –≤ `.github/workflows/ci.yml`:

```yaml
- name: Run PyTest
  working-directory: ./back
  env:
    CI: true
  run: |
    pytest -v --cov=server --cov=serial_reader
```

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–õ–æ–∫–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ:** Serial –ø–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ  
‚úÖ **CI/CD —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ:** Serial –ø–æ—Ä—Ç –ø—Ä–æ–ø—É—Å–∫–∞—î—Ç—å—Å—è, —Ç–µ—Å—Ç–∏ –ø—Ä–∞—Ü—é—é—Ç—å  
‚úÖ **–¢–µ—Å—Ç–∏:** –í—Å—ñ unit —Ç–µ—Å—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–æ  
‚úÖ **–ü–æ–∫—Ä–∏—Ç—Ç—è –∫–æ–¥—É:** –§—É–Ω–∫—Ü—ñ—ó —Ç–µ—Å—Ç—É—é—Ç—å—Å—è, —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è  

---

## –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### –õ–æ–∫–∞–ª—å–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
```bash
# CI –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
python serial_reader.py
# Output: "Listening on COM4"
```

### CI/CD –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
```bash
# CI=true (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤ GitHub Actions)
pytest test_serial_reader.py
# Output: "CI/CD environment detected, skipping serial port initialization"
```

---

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–µ—Ä–µ–≤–∞–≥–∏

1. **Graceful degradation** - —è–∫—â–æ COM-–ø–æ—Ä—Ç –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–æ, –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–µ –ø–∞–¥–∞—î
2. **–¢–µ—Å—Ç–æ–≤–∞–Ω—ñ—Å—Ç—å** - –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–æ–∂–Ω–∞ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–æ –≤—ñ–¥ hardware
3. **CI/CD friendly** - —Ç–µ—Å—Ç–∏ –ø—Ä–∞—Ü—é—é—Ç—å –≤ –±—É–¥—å-—è–∫–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ
4. **Debug —Ä–µ–∂–∏–º** - –∑—Ä–æ–∑—É–º—ñ–ª—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Å—Ç–∞–Ω serial –ø–æ—Ä—Ç—É

---

## –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è

| –ó–º—ñ–Ω–Ω–∞ | –ó–Ω–∞—á–µ–Ω–Ω—è | –ï—Ñ–µ–∫—Ç |
|--------|----------|-------|
| `CI=true` | GitHub Actions –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ | –ü—Ä–æ–ø—É—Å–∫–∞—î —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é serial –ø–æ—Ä—Ç—É |
| `CI` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ | –õ–æ–∫–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ | –ù–æ—Ä–º–∞–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ –∑ COM-–ø–æ—Ä—Ç–æ–º |

---

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ

–©–æ–± –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É CI/CD –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# –°–∏–º—É–ª—é–≤–∞—Ç–∏ CI/CD —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
export CI=true  # Linux/Mac
set CI=true     # Windows CMD
$env:CI="true"  # Windows PowerShell

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç–∏
pytest test_serial_reader.py -v
```

–î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏:

```bash
# –í–∏–¥–∞–ª–∏—Ç–∏ –∑–º—ñ–Ω–Ω—É
unset CI        # Linux/Mac
set CI=         # Windows CMD
Remove-Item Env:CI  # Windows PowerShell
```

---

## –í–∏—Å–Ω–æ–≤–æ–∫

–ü—Ä–æ–±–ª–µ–º–∞ –≤–∏—Ä—ñ—à–µ–Ω–∞ —à–ª—è—Ö–æ–º:
- ‚úÖ –£–º–æ–≤–Ω–æ—ó —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó serial –ø–æ—Ä—Ç—É
- ‚úÖ –ó–∞—Ö–∏—Å—Ç—É main loop
- ‚úÖ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è CI –∑–º—ñ–Ω–Ω–æ—ó –≤ —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ –Ø–≤–Ω–æ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –≤ GitHub Actions

**–°—Ç–∞—Ç—É—Å:** –í—Å—ñ —Ç–µ—Å—Ç–∏ —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—é—Ç—å –≤ CI/CD ‚úÖ

---

**–î–∞—Ç–∞:** 23.11.2025  
**–ê–≤—Ç–æ—Ä:** CI/CD Configuration

